!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.transformable=e():t.transformable=e()}(this,function(){return function(t){function e(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return t[o].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),r=n(1),a=o(r),u=n(2),h=o(u),l=n(3),c=(o(l),function(){function t(e,n){i(this,t),(0,a.default)(this),this.element=e,this.container=n,this.lastState={x:this.element.offsetLeft+this.element.offsetWidth/2,y:this.element.offsetTop+this.element.offsetHeight/2,width:this.element.offsetWidth,height:this.element.offsetHeight,compensation:{x:0,y:0},angle:0},this.currentState=h.default.Dup(this.lastState),this.element.style.top="0px",this.element.style.bottom="0px",this.element.style.left="0px",this.element.style.right="0px",this.moveInfos={},this.resizeInfos={},this.rotationInfos={},this.rotationStep=5,this.minimumSize=10,this._resizeOnMousedownBound=this._resizeOnMousedown.bind(this),this._resizeOnMousemoveBound=this._resizeOnMousemove.bind(this),this._resizeOnMouseupBound=this._resizeOnMouseup.bind(this),this._moveOnMousedownBound=this._moveOnMousedown.bind(this),this._moveOnMousemoveBound=this._moveOnMousemove.bind(this),this._moveOnMouseupBound=this._moveOnMouseup.bind(this),this._rotationOnMousedownBound=this._rotationOnMousedown.bind(this),this._rotationOnMousemoveBound=this._rotationOnMousemove.bind(this),this._rotationOnMouseupBound=this._rotationOnMouseup.bind(this),this._addHandles(),this.update()}return s(t,[{key:"disable",value:function(){this.handles.classList.add("hidden")}},{key:"enable",value:function(){this.handles.classList.remove("hidden")}},{key:"moveBy",value:function(t){this.currentState.x+=t.x,this.currentState.y+=t.y}},{key:"moveTo",value:function(t){this.currentState.x=t.x,this.currentState.y=t.y}},{key:"resizeBy",value:function(t){t.left=t.left||0,t.right=t.right||0,t.top=t.top||0,t.bottom=t.bottom||0;var e={x:t.right+t.left,y:t.top+t.bottom};this.currentState.width+e.x<this.minimumSize&&(e.x=this.minimumSize-this.currentState.width),this.currentState.height+e.y<this.minimumSize&&(e.y=this.minimumSize-this.currentState.height),this.currentState.width+=e.x,0!=t.left&&(this.currentState.compensation.x-=e.x/2),0!=t.right&&(this.currentState.compensation.x+=e.x/2),this.currentState.height+=e.y,0!=t.top&&(this.currentState.compensation.y-=e.y/2),0!=t.bottom&&(this.currentState.compensation.y+=e.y/2)}},{key:"rotateBy",value:function(t){this.currentState.angle+=t}},{key:"rotateTo",value:function(t){this.currentState.angle=t}},{key:"update",value:function(){this._transform(!0),this._normalize()}},{key:"center",value:function(){var t=this.element.getBoundingClientRect();return{x:t.left+t.width/2,y:t.top+t.height/2}}},{key:"width",value:function(){return this.currentState.width}},{key:"height",value:function(){return this.currentState.height}},{key:"position",value:function(){return{x:this.currentState.x,y:this.currentState.y}}},{key:"angle",value:function(){return this.currentState.angle}},{key:"_addHandles",value:function(){this.element.insertAdjacentHTML("beforeend",'<div class="handles noselect"></div>'),this.handles=this.element.querySelector(".handles"),this._addMoveHandle(),this._addResizeHandles(),this._addRotationHandle()}},{key:"_addResizeHandles",value:function(){var t=["tl","tm","tr","ml","mr","bl","bm","br"];this.resize_handles={};var e=!0,n=!1,o=void 0;try{for(var i,s=t[Symbol.iterator]();!(e=(i=s.next()).done);e=!0){var r=i.value;this.handles.insertAdjacentHTML("beforeend","<span class='resize_handles "+r+"'></span>"),this.resize_handles[r]=this.element.querySelector(".resize_handles."+r),this.resize_handles[r].addEventListener("mousedown",this._resizeOnMousedownBound)}}catch(t){n=!0,o=t}finally{try{!e&&s.return&&s.return()}finally{if(n)throw o}}}},{key:"_addMoveHandle",value:function(){this.handles.insertAdjacentHTML("beforeend","\n        <span class='move_handle'></span>\n    "),this.move_handle=this.element.querySelector(".move_handle"),this.move_handle.addEventListener("mousedown",this._moveOnMousedownBound)}},{key:"_addRotationHandle",value:function(){this.handles.insertAdjacentHTML("beforeend","\n        <span class='rotation_handle'></span>\n    "),this.rotation_handle=this.element.querySelector(".rotation_handle"),this.rotation_handle.addEventListener("mousedown",this._rotationOnMousedownBound)}},{key:"_transform",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this.currentState,n="\n      translate("+e.x+"px, "+e.y+"px)\n      rotate("+e.angle+"deg)\n      translate(calc("+e.compensation.x+"px - 50%), calc("+e.compensation.y+"px - 50%))\n      ";this.element.style.width=e.width+"px",this.element.style.height=e.height+"px",this.element.style.transform=n,this.element.style.transformOrigin="left top",t&&(this.lastState=h.default.Dup(e))}},{key:"_normalize",value:function(){var t=this.center();this.currentState.x=t.x,this.currentState.y=t.y,this.currentState.compensation={x:0,y:0},this._transform()}},{key:"_moveOnMousedown",value:function(t){0==t.button&&(this.emit("move:start"),this.moveInfos.initial={x:this.currentState.x,y:this.currentState.y},this.moveInfos.mouse={x:t.clientX,y:t.clientY},this.container.addEventListener("mousemove",this._moveOnMousemoveBound),document.addEventListener("mouseup",this._moveOnMouseupBound))}},{key:"_moveOnMousemove",value:function(t){this.emit("move:ongoing");var e={x:t.clientX-this.moveInfos.mouse.x+this.moveInfos.initial.x,y:t.clientY-this.moveInfos.mouse.y+this.moveInfos.initial.y};this.moveTo(e),this._transform()}},{key:"_moveOnMouseup",value:function(t){this.emit("move:stop"),this.update(),this.container.removeEventListener("mousemove",this._moveOnMousemoveBound),document.removeEventListener("mouseup",this._moveOnMouseupBound)}},{key:"_resizeOnMousedown",value:function(t){if(0==t.button){this.emit("resize:start");var e=Object.keys(this.resize_handles).filter(function(e){return t.target.classList.contains(e)})[0];this.resizeInfos.resize={left:e.includes("l"),right:e.includes("r"),top:e.includes("t"),bottom:e.includes("b")},this.resizeInfos.mouse={x:t.clientX,y:t.clientY},this.container.addEventListener("mousemove",this._resizeOnMousemoveBound),document.addEventListener("mouseup",this._resizeOnMouseupBound)}}},{key:"_resizeOnMousemove",value:function(t){this.emit("resize:ongoing");var e=this.center(),n={x:this.resizeInfos.mouse.x-e.x,y:this.resizeInfos.mouse.y-e.y},o={x:t.clientX-e.x,y:t.clientY-e.y};n=h.default.Rotate(n,-this.currentState.angle),o=h.default.Rotate(o,-this.currentState.angle);var i={x:o.x-n.x,y:o.y-n.y},s={left:0,right:0,top:0,bottom:0};this.resizeInfos.resize.left&&(s.left=-i.x),this.resizeInfos.resize.right&&(s.right=i.x),this.resizeInfos.resize.top&&(s.top=-i.y),this.resizeInfos.resize.bottom&&(s.bottom=i.y),this.currentState=h.default.Dup(this.lastState),this.resizeBy(s),this._transform(!1)}},{key:"_resizeOnMouseup",value:function(t){this.emit("resize:stop"),this.update(),this.container.removeEventListener("mousemove",this._resizeOnMousemoveBound),document.removeEventListener("mouseup",this._resizeOnMouseupBound)}},{key:"_rotationOnMousedown",value:function(t){0==t.button&&(this.emit("rotation:start"),this.rotationInfos.angle=this.currentState.angle,this.rotationInfos.center=this.center(),this.rotationInfos.centerToMouse={x:t.clientX-this.rotationInfos.center.x,y:this.rotationInfos.center.y-t.clientY},this.container.addEventListener("mousemove",this._rotationOnMousemoveBound),document.addEventListener("mouseup",this._rotationOnMouseupBound))}},{key:"_rotationOnMousemove",value:function(t){this.emit("rotation:ongoing");var e={x:t.clientX-this.rotationInfos.center.x,y:this.rotationInfos.center.y-t.clientY},n=h.default.Angle(this.rotationInfos.centerToMouse,e);n=Math.round(n/this.rotationStep)*this.rotationStep,this.rotateTo(this.rotationInfos.angle+n),this._transform()}},{key:"_rotationOnMouseup",value:function(t){this.emit("rotation:stop"),this.update(),this.container.removeEventListener("mousemove",this._rotationOnMousemoveBound),document.removeEventListener("mouseup",this._rotationOnMouseupBound)}}]),t}());e.default=c},function(t,e){t.exports=function(t){var e={},n=[];t=t||this,t.on=function(n,o,i){return(e[n]=e[n]||[]).push([o,i]),t},t.off=function(o,i){o||(e={});for(var s=e[o]||n,r=s.length=i?s.length:0;r--;)i==s[r][0]&&s.splice(r,1);return t},t.emit=function(o){for(var i,s=e[o]||n,r=s.length>0?s.slice(0,s.length):s,a=0;i=r[a++];)i[0].apply(i[1],n.slice.call(arguments,1));return t}}},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),i=function(){function t(){n(this,t)}return o(t,null,[{key:"Angle",value:function(e,n){return 180*Math.atan2(t.Cross(n,e),t.Dot(n,e))/Math.PI}},{key:"Dot",value:function(t,e){return t.x*e.x+t.y*e.y}},{key:"Cross",value:function(t,e){return t.x*e.y-t.y*e.x}},{key:"Rotate",value:function(t,e){var n=Math.PI/180*e,o=Math.cos(n),i=Math.sin(n);return{x:o*t.x-i*t.y,y:o*t.y+i*t.x}}},{key:"Dup",value:function(t){return JSON.parse(JSON.stringify(t))}},{key:"Wrap",value:function(t,e){t.parentNode.insertBefore(e,t),e.appendChild(t)}}]),t}();e.default=i},function(t,e){"use strict";function n(t){return o("string"!=typeof t?i(t):t)}function o(t){var e=s(t),n=e[0],o=e[1],i=e[2],u=e[3];if(n*u==o*i)throw new Error("transform#unmatrix: matrix is singular");var h=Math.sqrt(n*n+o*o);n/=h,o/=h;var l=n*i+o*u;i-=n*l,u-=o*l;var c=Math.sqrt(i*i+u*u);return i/=c,u/=c,l/=c,n*u<o*i&&(n=-n,o=-o,l=-l,h=-h),{translateX:e[4],translateY:e[5],rotate:r(Math.atan2(o,n)),skew:r(Math.atan(l)),scaleX:a(h),scaleY:a(c)}}function i(t){var e=window.getComputedStyle(t);return e.getPropertyValue("transform")||e.getPropertyValue("-webkit-transform")||e.getPropertyValue("-moz-transform")||e.getPropertyValue("-ms-transform")||e.getPropertyValue("-o-transform")}function s(t){var e=[];if(window.WebKitCSSMatrix)return e=new window.WebKitCSSMatrix(t),[e.a,e.b,e.c,e.d,e.e,e.f];for(var n,o=/[\d\.\-]+/g;n=o.exec(t);)e.push(+n);return e}function r(t){var e=180*t/Math.PI;return a(e)}function a(t){return Math.round(100*t)/100}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n}])});
//# sourceMappingURL=transformable.min.js.map
